<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Bootstrap Simulation Error — estimate_boot_sim_cv • svrep</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Bootstrap Simulation Error — estimate_boot_sim_cv"><meta name="description" content='Estimates the bootstrap simulation error, expressed as a "simulation coefficient of variation" (CV).'><meta property="og:description" content='Estimates the bootstrap simulation error, expressed as a "simulation coefficient of variation" (CV).'><meta property="og:image" content="https://bschneidr.github.io/svrep/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">svrep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bootstrap-replicates.html">Bootstrap Methods for Surveys</a></li>
    <li><a class="dropdown-item" href="../articles/nonresponse-adjustments.html">Nonresponse Adjustments</a></li>
    <li><a class="dropdown-item" href="../articles/sample-based-calibration.html">Calibrating to Estimated Control Totals</a></li>
    <li><a class="dropdown-item" href="../articles/two-phase-sampling.html">Replication Methods for Two-phase Sampling</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bschneidr/svrep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate Bootstrap Simulation Error</h1>
      <small class="dont-index">Source: <a href="https://github.com/bschneidr/svrep/blob/main/R/bootstrap_helpers.R" class="external-link"><code>R/bootstrap_helpers.R</code></a></small>
      <div class="d-none name"><code>estimate_boot_sim_cv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the bootstrap simulation error, expressed as a "simulation coefficient of variation" (CV).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_boot_sim_cv</span><span class="op">(</span><span class="va">svrepstat</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-svrepstat">svrepstat<a class="anchor" aria-label="anchor" href="#arg-svrepstat"></a></dt>
<dd><p>An estimate obtained from a bootstrap replicate survey design object,
with a function such as <code>svymean(..., return.replicates = TRUE)</code> or <code>withReplicates(..., return.replicates = TRUE)</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>sim_cv_estimate</code>,
with methods <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.
Call <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to get a data frame with one row for each statistic.
The column <code>STATISTIC</code> gives the name of the statistic.
The column <code>SIMULATION_CV</code> gives the estimated simulation CV of the statistic.
The column <code>N_REPLICATES</code> gives the number of bootstrap replicates.</p>
<p>This object has no plot method. To produce plots, use the
closely-related function <code><a href="estimate_boot_reps_for_target_cv.html">estimate_boot_reps_for_target_cv</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="statistical-details">Statistical Details<a class="anchor" aria-label="anchor" href="#statistical-details"></a></h2>


<p>Unlike other replication methods such as the jackknife or balanced repeated replication,
 the bootstrap variance estimator's precision can always be improved by using a
 larger number of replicates, as the use of only a finite number of bootstrap replicates
 introduces simulation error to the variance estimation process.
 Simulation error can be measured as a "simulation coefficient of variation" (CV), which is
 the ratio of the standard error of a bootstrap estimator to the expectation of that bootstrap estimator,
 where the expectation and standard error are evaluated with respect to the bootstrapping process
 given the selected sample.</p>
<p>For a statistic \(\hat{\theta}\), the simulation CV of the bootstrap variance estimator
 \(v_{B}(\hat{\theta})\) based on \(B\) replicate estimates \(\hat{\theta}^{\star}_1,\dots,\hat{\theta}^{\star}_B\) is defined as follows:
 $$
   CV_{\star}(v_{B}(\hat{\theta})) = \frac{\sqrt{var_{\star}(v_B(\hat{\theta}))}}{E_{\star}(v_B(\hat{\theta}))} = \frac{CV_{\star}(E_2)}{\sqrt{B}}
 $$
 where
 $$
   E_2 = (\hat{\theta}^{\star} - \hat{\theta})^2
 $$
 $$
   CV_{\star}(E_2) = \frac{\sqrt{var_{\star}(E_2)}}{E_{\star}(E_2)}
 $$
 and \(var_{\star}\) and \(E_{\star}\) are evaluated with respect to
 the bootstrapping process, given the selected sample.
<br><br>
 The simulation CV, denoted \(CV_{\star}(v_{B}(\hat{\theta}))\), is estimated for a given number of replicates \(B\)
 by estimating \(CV_{\star}(E_2)\) using observed values and dividing this by \(\sqrt{B}\). If the bootstrap errors
 are assumed to be normally distributed, then \(CV_{\star}(E_2)=\sqrt{2}\) and so \(CV_{\star}(v_{B}(\hat{\theta}))\) would not need to be estimated.
 Using observed replicate estimates to estimate the simulation CV instead of assuming normality allows simulation CV to be
 used for a a wide array of bootstrap methods.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>See Section 3.3 and Section 8 of Beaumont and Patak (2012) for details and an example where the simulation CV is used
 to determine the number of bootstrap replicates needed for various alternative bootstrap methods in an empirical illustration.</p>
<p>Beaumont, J.-F. and Z. Patak. (2012),
 "On the Generalized Bootstrap for Sample Surveys with Special Attention to Poisson Sampling."
 <strong>International Statistical Review</strong>, <em>80</em>: 127-148. <a href="https://doi.org/10.1111/j.1751-5823.2011.00166.x" class="external-link">doi:10.1111/j.1751-5823.2011.00166.x</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Use <code><a href="estimate_boot_reps_for_target_cv.html">estimate_boot_reps_for_target_cv</a></code> to help choose the number of bootstrap replicates.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2022</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create an example bootstrap survey design object ----</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'api'</span>, package <span class="op">=</span> <span class="st">'survey'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">boot_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="fl">1</span>,strata<span class="op">=</span><span class="op">~</span><span class="va">stype</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>,</span></span>
<span class="r-in"><span>                         data<span class="op">=</span><span class="va">apistrat</span>, fpc<span class="op">=</span><span class="op">~</span><span class="va">fpc</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_bootstrap_design.html">as_bootstrap_design</a></span><span class="op">(</span>replicates <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate estimates of interest and retain estimates from each replicate ----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">estimated_means_and_proportions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svymean</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="op">~</span> <span class="va">api00</span> <span class="op">+</span> <span class="va">api99</span> <span class="op">+</span> <span class="va">stype</span>, </span></span>
<span class="r-in"><span>  design <span class="op">=</span> <span class="va">boot_design</span>,</span></span>
<span class="r-in"><span>  return.replicates <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">custom_statistic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/withReplicates.html" class="external-link">withReplicates</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  design <span class="op">=</span> <span class="va">boot_design</span>,</span></span>
<span class="r-in"><span>  return.replicates <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">wts</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">numerator</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">api00</span> <span class="op">*</span> <span class="va">wts</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">denominator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">api99</span> <span class="op">*</span> <span class="va">wts</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">statistic</span>   <span class="op">&lt;-</span> <span class="va">numerator</span><span class="op">/</span><span class="va">denominator</span></span></span>
<span class="r-in"><span>     <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Estimate simulation CV of bootstrap estimates ----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">estimate_boot_sim_cv</span><span class="op">(</span></span></span>
<span class="r-in"><span>    svrepstat <span class="op">=</span> <span class="va">estimated_means_and_proportions</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   STATISTIC SIMULATION_CV N_REPLICATES</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     api00    0.01153215         5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     api99    0.01153118         5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    stypeE    0.01735963         5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    stypeH    0.01735958         5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    stypeM    0.01735958         5000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">estimate_boot_sim_cv</span><span class="op">(</span></span></span>
<span class="r-in"><span>    svrepstat <span class="op">=</span> <span class="va">custom_statistic</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The elements of `svrepstat` are unnamed. Placeholder names (STATISTIC_1, etc.) will be used instead.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     STATISTIC SIMULATION_CV N_REPLICATES</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 STATISTIC_1    0.01988987         5000</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Schneider.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

