<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Weights for "Doubled Half Bootstrap" of Antal and Tillé (2014) — make_doubled_half_bootstrap_weights • svrep</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weights for " doubled half bootstrap of antal and till make_doubled_half_bootstrap_weights><meta name="description" content="Creates bootstrap replicate weights using the method of Antal and Tillé (2014).
This method is applicable to single-stage sample designs, potentially
with stratification and clustering. It can be used for designs that use
simple random sampling without replacement or unequal probability sampling without replacement.
One advantage of this method is that it yields integer replicate factors of 0, 1, 2, or 3."><meta property="og:description" content="Creates bootstrap replicate weights using the method of Antal and Tillé (2014).
This method is applicable to single-stage sample designs, potentially
with stratification and clustering. It can be used for designs that use
simple random sampling without replacement or unequal probability sampling without replacement.
One advantage of this method is that it yields integer replicate factors of 0, 1, 2, or 3."><meta property="og:image" content="https://bschneidr.github.io/svrep/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">svrep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bootstrap-replicates.html">Bootstrap Methods for Surveys</a></li>
    <li><a class="dropdown-item" href="../articles/nonresponse-adjustments.html">Nonresponse Adjustments</a></li>
    <li><a class="dropdown-item" href="../articles/sample-based-calibration.html">Calibrating to Estimated Control Totals</a></li>
    <li><a class="dropdown-item" href="../articles/two-phase-sampling.html">Replication Methods for Two-phase Sampling</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bschneidr/svrep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Weights for "Doubled Half Bootstrap" of Antal and Tillé (2014)</h1>
      <small class="dont-index">Source: <a href="https://github.com/bschneidr/svrep/blob/v0.9.0/R/make_bootstrap_weights.R" class="external-link"><code>R/make_bootstrap_weights.R</code></a></small>
      <div class="d-none name"><code>make_doubled_half_bootstrap_weights.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates bootstrap replicate weights using the method of Antal and Tillé (2014).
This method is applicable to single-stage sample designs, potentially
with stratification and clustering. It can be used for designs that use
simple random sampling without replacement or unequal probability sampling without replacement.
One advantage of this method is that it yields integer replicate factors of 0, 1, 2, or 3.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">make_doubled_half_bootstrap_weights</span><span class="op">(</span></span>
<span>  num_replicates <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">samp_unit_ids</span>,</span>
<span>  <span class="va">strata_ids</span>,</span>
<span>  <span class="va">samp_unit_sel_probs</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"weights"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-num-replicates">num_replicates<a class="anchor" aria-label="anchor" href="#arg-num-replicates"></a></dt>
<dd><p>Positive integer giving the number of bootstrap replicates to create.</p></dd>


<dt id="arg-samp-unit-ids">samp_unit_ids<a class="anchor" aria-label="anchor" href="#arg-samp-unit-ids"></a></dt>
<dd><p>Vector of sampling unit IDs.</p></dd>


<dt id="arg-strata-ids">strata_ids<a class="anchor" aria-label="anchor" href="#arg-strata-ids"></a></dt>
<dd><p>Vector of strata IDs for each sampling unit at each stage of sampling.</p></dd>


<dt id="arg-samp-unit-sel-probs">samp_unit_sel_probs<a class="anchor" aria-label="anchor" href="#arg-samp-unit-sel-probs"></a></dt>
<dd><p>Vector of selection probabilities for each sampling unit.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>Either <code>"weights"</code> (the default) or <code>"factors"</code>.
Specifying <code>output = "factors"</code> returns a matrix of replicate adjustment factors which can later be multiplied by
the full-sample weights to produce a matrix of replicate weights. Specifying <code>output = "weights"</code>
returns the matrix of replicate weights, where the full-sample weights are inferred using <code>samp_unit_sel_probs</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix of with the same number of rows as <code>samp_unit_ids</code>
and the number of columns equal to the value of the argument <code>num_replicates</code>.
Specifying <code>output = "factors"</code> returns a matrix of replicate adjustment factors which can later be multiplied by
the full-sample weights to produce a matrix of replicate weights.
Specifying <code>output = "weights"</code> returns the matrix of replicate weights,
where the full-sample weights are inferred using <code>samp_unit_sel_probs</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For stratified sampling, the replicate factors are generated independently in each stratum.
For cluster sampling at a given stage, the replicate factors are generated
at the cluster level and then the cluster's replicate factors are applied to all units in the cluster.</p>
<p>In the case of unequal probability sampling, this bootstrap method is
only recommended for high entropy sampling methods (i.e., most methods other
than systematic sampling).</p>
<p>See Section 7 of Antal and Tillé (2014)
for a clear description of how the replicates are formed.
The paper presents two options for the resampling probabilities
used in replication: the R function uses the option
referred to in the paper as "the \(\pi\)-bootstrap."</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Antal, E. and Tillé, Y. (2014).
"A new resampling method for sampling designs without replacement: The doubled half bootstrap."
<strong>Computational Statistics</strong>, <em>29</em>(5), 1345-1363. https://doi.org/10.1007/s00180-014-0495-0</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>If the survey design can be accurately represented using <code><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></code>,
 then it is easier to simply use <code><a href="as_bootstrap_design.html">as_bootstrap_design</a></code> with argument <code>type = "Antal-Tille"</code>.</p>
<p>Use <code><a href="estimate_boot_reps_for_target_cv.html">estimate_boot_reps_for_target_cv</a></code> to help choose the number of bootstrap replicates.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># Example 1: A cluster sample</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'library_multistage_sample'</span>, package <span class="op">=</span> <span class="st">'svrep'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>   <span class="va">replicate_factors</span> <span class="op">&lt;-</span> <span class="fu">make_doubled_half_bootstrap_weights</span><span class="op">(</span></span></span>
<span class="r-in"><span>     num_replicates      <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>     samp_unit_ids       <span class="op">=</span> <span class="va">library_multistage_sample</span><span class="op">$</span><span class="va">PSU_ID</span>,</span></span>
<span class="r-in"><span>     strata_ids          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">library_multistage_sample</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     samp_unit_sel_probs <span class="op">=</span> <span class="va">library_multistage_sample</span><span class="op">$</span><span class="va">PSU_SAMPLING_PROB</span>,</span></span>
<span class="r-in"><span>     output              <span class="op">=</span> <span class="st">"factors"</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 2: A single-stage sample selected with unequal probabilities, without replacement</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Load an example dataset of U.S. counties states with 2004 Presidential vote counts</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"election"</span>, package <span class="op">=</span> <span class="st">'survey'</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">pps_wor_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">election_pps</span>,</span></span>
<span class="r-in"><span>                               pps <span class="op">=</span> <span class="st">"overton"</span>,</span></span>
<span class="r-in"><span>                               fpc <span class="op">=</span> <span class="op">~</span> <span class="va">p</span>, <span class="co"># Inclusion probabilities</span></span></span>
<span class="r-in"><span>                               ids <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Create bootstrap replicate weights</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2022</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">bootstrap_replicate_weights</span> <span class="op">&lt;-</span> <span class="fu">make_doubled_half_bootstrap_weights</span><span class="op">(</span></span></span>
<span class="r-in"><span>     num_replicates      <span class="op">=</span> <span class="fl">5000</span>,</span></span>
<span class="r-in"><span>     samp_unit_ids       <span class="op">=</span> <span class="va">pps_wor_design</span><span class="op">$</span><span class="va">cluster</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     strata_ids          <span class="op">=</span> <span class="va">pps_wor_design</span><span class="op">$</span><span class="va">strata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     samp_unit_sel_probs <span class="op">=</span> <span class="va">pps_wor_design</span><span class="op">$</span><span class="va">prob</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Create a replicate design object with the survey package</span></span></span>
<span class="r-in"><span>   <span class="va">bootstrap_rep_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svrepdesign.html" class="external-link">svrepdesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     data       <span class="op">=</span> <span class="va">pps_wor_design</span><span class="op">$</span><span class="va">variables</span>,</span></span>
<span class="r-in"><span>     repweights <span class="op">=</span> <span class="va">bootstrap_replicate_weights</span>,</span></span>
<span class="r-in"><span>     weights    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/weights.html" class="external-link">weights</a></span><span class="op">(</span><span class="va">pps_wor_design</span>, type <span class="op">=</span> <span class="st">"sampling"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     type       <span class="op">=</span> <span class="st">"bootstrap"</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Compare std. error estimates from bootstrap versus linearization</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     <span class="st">'Statistic'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'total'</span>, <span class="st">'mean'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     <span class="st">'SE (bootstrap)'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/SE.html" class="external-link">SE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svytotal</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">~</span> <span class="va">Bush</span>, design <span class="op">=</span> <span class="va">bootstrap_rep_design</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          <span class="fu"><a href="https://rdrr.io/pkg/survey/man/SE.html" class="external-link">SE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svymean</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Bush</span><span class="op">/</span><span class="va">votes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     design <span class="op">=</span> <span class="va">bootstrap_rep_design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     <span class="st">'SE (Overton\'s PPS approximation)'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/SE.html" class="external-link">SE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svytotal</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">~</span> <span class="va">Bush</span>,</span></span>
<span class="r-in"><span>                                                         design <span class="op">=</span> <span class="va">pps_wor_design</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                             <span class="fu"><a href="https://rdrr.io/pkg/survey/man/SE.html" class="external-link">SE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svymean</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Bush</span><span class="op">/</span><span class="va">votes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                                        design <span class="op">=</span> <span class="va">pps_wor_design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     check.names <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistic SE (bootstrap) SE (Overton's PPS approximation)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     total   2.437243e+06                     2.939608e+06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      mean   1.359043e-01                     1.089739e-01</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Schneider.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

