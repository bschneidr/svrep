<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="svrep">
<title>Nonresponse Adjustments • svrep</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nonresponse Adjustments">
<meta property="og:description" content="svrep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">svrep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.4.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bootstrap-replicates.html">Bootstrap Methods for Surveys</a>
    <a class="dropdown-item" href="../articles/nonresponse-adjustments.html">Nonresponse Adjustments</a>
    <a class="dropdown-item" href="../articles/sample-based-calibration.html">Calibrating to Estimated Control Totals</a>
    <a class="dropdown-item" href="../articles/two-phase-sampling.html">Replication Methods for Two-phase Sampling</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bschneidr/svrep/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Nonresponse Adjustments</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bschneidr/svrep/blob/HEAD/vignettes/nonresponse-adjustments.Rmd" class="external-link"><code>vignettes/nonresponse-adjustments.Rmd</code></a></small>
      <div class="d-none name"><code>nonresponse-adjustments.Rmd</code></div>
    </div>

    
    
<p>In this short vignette, we’ll demonstrate how the svrep package can
be used to implement weighting adjustments for nonresponse in survey
samples. For illustration, we’ll use an example survey measuring
Covid-19 vaccination status and a handful of demographic variables,
based on a simple random sample of 1,000 residents of Louisville,
Kentucky.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># For data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a></span><span class="op">)</span> <span class="co"># For complex survey analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://gdfe.co/srvyr/" class="external-link">srvyr</a></span><span class="op">)</span> <span class="co"># For complex survey analysis with dplyr syntax</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bschneidr.github.io/svrep/">svrep</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load and inspect the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lou_vax_survey"</span>, package <span class="op">=</span> <span class="st">'svrep'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lou_vax_survey</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   RESPONSE_STATUS RACE_ETHNICITY                SEX   EDUC_ATTAINMENT VAX_STATUS</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Nonrespondent   White alone, not Hispanic or… Fema… Less than high… <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Nonrespondent   Black or African American al… Fema… High school or… <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Respondent      White alone, not Hispanic or… Fema… Less than high… Vaccinated</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Nonrespondent   White alone, not Hispanic or… Fema… Less than high… <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Nonrespondent   White alone, not Hispanic or… Fema… High school or… <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Respondent      White alone, not Hispanic or… Fema… High school or… Vaccinated</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: SAMPLING_WEIGHT &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lou_vax_survey</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "RESPONSE_STATUS" "RACE_ETHNICITY"  "SEX"             "EDUC_ATTAINMENT"</span></span>
<span><span class="co">#&gt; [5] "VAX_STATUS"      "SAMPLING_WEIGHT"</span></span></code></pre></div>
<p>This vaccination survey has an overall response rate of 50.2%, which
means that estimated vaccination rates may be significantly biased by
nonresponse. We’ll use nonresponse weighting adjustments to try and
reduce potential nonresponse bias.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lou_vax_survey</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">RESPONSE_STATUS</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pct <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   RESPONSE_STATUS     n   pct</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Nonrespondent     498 0.498</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Respondent        502 0.502</span></span></code></pre></div>
<div class="section level2">
<h2 id="creating-initial-replicate-weights">Creating initial replicate weights<a class="anchor" aria-label="anchor" href="#creating-initial-replicate-weights"></a>
</h2>
<p>To begin with, we’ll create bootstrap replicate weights. In most
cases, we can do this simply by describing the survey design using the
<code><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign()</a></code> function and then using a function to create
appropriate replicate weights. The function
<code><a href="https://rdrr.io/pkg/survey/man/as.svrepdesign.html" class="external-link">as.svrepdesign()</a></code> from the ‘survey’ package can be used to
create several types of replicate weights, using the argument
<code>type</code> (with options <code>'JK1'</code>, <code>'JKn'</code>,
<code>'bootstrap'</code>, <code>'BRR'</code>, <code>'Fay'</code>, etc.)
In addition, the function <code><a href="../reference/as_bootstrap_design.html">as_bootstrap_design()</a></code> can be used
to create bootstrap weights using additional methods not supported in
the ‘survey’ package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Describe the survey design</span></span>
<span><span class="va">lou_vax_survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span>ids <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, weights <span class="op">=</span> <span class="op">~</span> <span class="va">SAMPLING_WEIGHT</span>,</span>
<span>                            data <span class="op">=</span> <span class="va">lou_vax_survey</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lou_vax_survey</span><span class="op">)</span></span>
<span><span class="co">#&gt; Independent Sampling design (with replacement)</span></span>
<span><span class="co">#&gt; svydesign(ids = ~1, weights = ~SAMPLING_WEIGHT, data = lou_vax_survey)</span></span>
<span></span>
<span><span class="co"># Create appropriate replicate weights</span></span>
<span><span class="va">lou_vax_survey</span> <span class="op">&lt;-</span> <span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_bootstrap_design.html">as_bootstrap_design</a></span><span class="op">(</span>replicates <span class="op">=</span> <span class="fl">100</span>, mse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      type <span class="op">=</span> <span class="st">"Rao-Wu-Yue-Beaumont"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lou_vax_survey</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: as_bootstrap_design(lou_vax_survey, replicates = 100, mse = TRUE, </span></span>
<span><span class="co">#&gt;     type = "Rao-Wu-Yue-Beaumont")</span></span>
<span><span class="co">#&gt; Survey bootstrap with 100 replicates and MSE variances.</span></span></code></pre></div>
<p>For convenience, we’ll convert this survey design object into an
object with class <code>tbl_svy</code>, which allows us to use
convenient tidyverse/dplyr syntax (<code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code>,
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code>, etc.) as well as other helpful functions from
the srvyr package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lou_vax_survey</span> <span class="op">&lt;-</span> <span class="va">lou_vax_survey</span> <span class="op">|&gt;</span> <span class="fu"><a href="http://gdfe.co/srvyr/reference/as_survey.html" class="external-link">as_survey</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lou_vax_survey</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: Called via srvyr</span></span>
<span><span class="co">#&gt; Survey bootstrap with 100 replicates and MSE variances.</span></span>
<span><span class="co">#&gt; Data variables: RESPONSE_STATUS (chr), RACE_ETHNICITY (chr), SEX (chr),</span></span>
<span><span class="co">#&gt;   EDUC_ATTAINMENT (chr), VAX_STATUS (chr), SAMPLING_WEIGHT (dbl)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="redistributing-weight-from-nonrespondents-to-respondents">Redistributing weight from nonrespondents to respondents<a class="anchor" aria-label="anchor" href="#redistributing-weight-from-nonrespondents-to-respondents"></a>
</h2>
<p>A common form of nonresponse adjustment is to simply ‘redistribute’
weight from the nonrespondents to the respondents. In other words, the
weight for each nonrespondent is set to <span class="math inline">\(0\)</span>, and the weight for each respondent is
increased by a factor greater than one so that the sum of adjusted
weights in the sample of respondents equals the sum of unadjusted
weights from the full sample. For example, if the sum of weights among
respondents is <span class="math inline">\(299,544.4\)</span> and the
sum of weights among nonrespondents is <span class="math inline">\(297,157.6\)</span>, then a basic nonresponse
adjustment would set the weights among nonrespondents to <span class="math inline">\(0\)</span> and multiply the weight for each
respondent by an adjustment factor equal to <span class="math inline">\(1 + (297,157.6/299,544.4)\)</span>. This type of
adjustment is succinctly described in mathematical notation below.</p>
<span class="math display">\[\begin{aligned}
w_i &amp;= \textit{Original sampling weight for case }i \\
    &amp;= 1/\pi_i, \textit{ where } \pi_i \textit{ is the probability
case i }\textit{had of being sampled}\\
f_{NR,i} &amp;= \textit{Nonresponse adjustment factor for case i} \\
w_{NR, i} &amp;= w_i \times f_{NR,i} = \textit{Weight for case }i
\textit{ after nonresponse adjustment} \\

\\
\sum_{i \in s_{resp}} w_i &amp;= \textit{Sum of sampling weights among
respondents} \\
\sum_{i \in s_{nonresp}} w_i &amp;= \textit{Sum of sampling weights
among nonrespondents} \\
\\
f_{NR_i} &amp;= \begin{cases}
     0 &amp; \textit{if case }i\textit{ is a nonrespondent} \\
     1 + \frac{\sum_{i \in s_{nonresp}} w_i}{\sum_{i \in s_{resp}} w_i}
&amp; \textit{if case }i\textit{ is a respondent}
           \end{cases}
\end{aligned}\]</span>
<p>We’ll illustrate this type of adjustment with the Louisville
vaccination survey. First, we’ll inspect the sum of the sampling weights
for respondents, nonrespondents, and the overall sample.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Weights before adjustment</span></span>
<span><span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">RESPONSE_STATUS</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="http://gdfe.co/srvyr/reference/cascade.html" class="external-link">cascade</a></span><span class="op">(</span></span>
<span>    `Sum of Weights` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="http://gdfe.co/srvyr/reference/cur_svy_wts.html" class="external-link">cur_svy_wts</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .fill <span class="op">=</span> <span class="st">"TOTAL"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   RESPONSE_STATUS `Sum of Weights`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Nonrespondent            <span style="text-decoration: underline;">297</span>158.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Respondent               <span style="text-decoration: underline;">299</span>544.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> TOTAL                    <span style="text-decoration: underline;">596</span>702</span></span></code></pre></div>
<p>Next, we’ll redistribute weight from nonrespondents to respondents
using the <code><a href="../reference/redistribute_weights.html">redistribute_weights()</a></code> function, which adjusts
the full-sample weights as well as each set of replicate weights. To
specify which subset of data should have its weights reduced, we supply
a logical expression to the argument <code>reduce_if</code>. To specify
which subset of data should have its weights increased, we supply a
logical expression to the argument <code>increase_if</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Conduct a basic nonresponse adjustment</span></span>
<span><span class="va">nr_adjusted_survey</span> <span class="op">&lt;-</span> <span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/redistribute_weights.html">redistribute_weights</a></span><span class="op">(</span></span>
<span>    reduce_if <span class="op">=</span> <span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Nonrespondent"</span>,</span>
<span>    increase_if <span class="op">=</span> <span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Respondent"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>After making the adjustment, we can check that all of the weight from
nonrespondents has been redistributed to respondents.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check the sum of full-sample weights by response status</span></span>
<span><span class="va">nr_adjusted_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">RESPONSE_STATUS</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="http://gdfe.co/srvyr/reference/cascade.html" class="external-link">cascade</a></span><span class="op">(</span></span>
<span>    `Sum of Weights` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="http://gdfe.co/srvyr/reference/cur_svy_wts.html" class="external-link">cur_svy_wts</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .fill <span class="op">=</span> <span class="st">"TOTAL"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   RESPONSE_STATUS `Sum of Weights`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Nonrespondent                  0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Respondent                <span style="text-decoration: underline;">596</span>702</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> TOTAL                     <span style="text-decoration: underline;">596</span>702</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check sums of replicate weights by response status</span></span>
<span><span class="va">nr_adjusted_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summarize_rep_weights.html">summarize_rep_weights</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">"specific"</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"RESPONSE_STATUS"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Rep_Column</span>, <span class="va">RESPONSE_STATUS</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    RESPONSE_STATUS Rep_Column   N N_NONZERO    SUM     MEAN        CV MIN</span></span>
<span><span class="co">#&gt; 1    Nonrespondent          1 498         0      0    0.000       NaN   0</span></span>
<span><span class="co">#&gt; 2       Respondent          1 502       309 596702 1188.649 1.0131335   0</span></span>
<span><span class="co">#&gt; 3    Nonrespondent          2 498         0      0    0.000       NaN   0</span></span>
<span><span class="co">#&gt; 4       Respondent          2 502       323 596702 1188.649 0.9866873   0</span></span>
<span><span class="co">#&gt; 5    Nonrespondent          3 498         0      0    0.000       NaN   0</span></span>
<span><span class="co">#&gt; 6       Respondent          3 502       319 596702 1188.649 0.9799219   0</span></span>
<span><span class="co">#&gt; 7    Nonrespondent          4 498         0      0    0.000       NaN   0</span></span>
<span><span class="co">#&gt; 8       Respondent          4 502       322 596702 1188.649 0.9697204   0</span></span>
<span><span class="co">#&gt; 9    Nonrespondent          5 498         0      0    0.000       NaN   0</span></span>
<span><span class="co">#&gt; 10      Respondent          5 502       323 596702 1188.649 0.9403356   0</span></span>
<span><span class="co">#&gt;         MAX</span></span>
<span><span class="co">#&gt; 1     0.000</span></span>
<span><span class="co">#&gt; 2  4962.179</span></span>
<span><span class="co">#&gt; 3     0.000</span></span>
<span><span class="co">#&gt; 4  5737.519</span></span>
<span><span class="co">#&gt; 5     0.000</span></span>
<span><span class="co">#&gt; 6  7247.393</span></span>
<span><span class="co">#&gt; 7     0.000</span></span>
<span><span class="co">#&gt; 8  4745.145</span></span>
<span><span class="co">#&gt; 9     0.000</span></span>
<span><span class="co">#&gt; 10 4792.787</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conducting-weighting-class-adjustments">Conducting weighting class adjustments<a class="anchor" aria-label="anchor" href="#conducting-weighting-class-adjustments"></a>
</h2>
<p>Nonresponse bias is liable to occur if different subpopulations
systematically differ in terms of their response rates to the survey and
also differ in terms of what the survey is trying to measure (in this
case, vaccination status). In our example, we can see some fairly large
differences in response rates across different race/ethnicity
groups.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">RACE_ETHNICITY</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>Response_Rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Respondent"</span><span class="op">)</span>,</span>
<span>            Sample_Size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            n_Respondents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Respondent"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   RACE_ETHNICITY                         Response_Rate Sample_Size n_Respondents</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Black or African American alone, not …         0.452         188            85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Hispanic or Latino                             0.378          45            17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Other Race, not Hispanic or Latino             0.492          59            29</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> White alone, not Hispanic or Latino            0.524         708           371</span></span></code></pre></div>
<p>Weighting adjustments may be able to help reduce nonresponse bias
caused by these differences in response rates. One standard form of
adjustment known as <strong>weighting class adjustment</strong> is to
redistribute weights from nonrespondents to respondents separately by
different categories of auxiliary variables (such as race/ethnicity).
The survey textbook Heeringa, West, and Berglund (2017) provides an
excellent overview of weighting class adjustments. To implement a
weighting class adjustment with the svrep package, we can simply use the
<code>by</code> argument of <code><a href="../reference/redistribute_weights.html">redistribute_weights()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nr_adjusted_survey</span> <span class="op">&lt;-</span> <span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/redistribute_weights.html">redistribute_weights</a></span><span class="op">(</span></span>
<span>    reduce_if <span class="op">=</span> <span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Nonrespondent"</span>,</span>
<span>    increase_if <span class="op">=</span> <span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Respondent"</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RACE_ETHNICITY"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Multiple grouping variables may be supplied to the <code>by</code>
argument. For example, one can specify
<code>by = c("STRATUM", "RACE_ETHNICITY")</code> to redistribute weights
separately by combinations of stratum and race/ethnicity category.</p>
<div class="section level3">
<h3 id="propensity-cell-adjustment">Propensity cell adjustment<a class="anchor" aria-label="anchor" href="#propensity-cell-adjustment"></a>
</h3>
<p>The popular method of forming weighting classes based on estimated
response propensities (known as <strong>propensity cell
adjustment</strong>) can also be used, for example by adding a variable
<code>PROPENSITY_CELL</code> to the data and using
<code>redistribute_weights(..., by = "PROPENSITY_CELL")</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a response propensity model</span></span>
<span><span class="va">response_propensity_model</span> <span class="op">&lt;-</span> <span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>IS_RESPONDENT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Respondent"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svyglm.html" class="external-link">svyglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">IS_RESPONDENT</span> <span class="op">~</span> <span class="va">RACE_ETHNICITY</span> <span class="op">+</span> <span class="va">EDUC_ATTAINMENT</span>,</span>
<span>         family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">quasibinomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">'logit'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict response propensities for individual cases</span></span>
<span><span class="va">lou_vax_survey</span> <span class="op">&lt;-</span> <span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    RESPONSE_PROPENSITY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">response_propensity_model</span>,</span>
<span>                                  newdata <span class="op">=</span> <span class="fu"><a href="http://gdfe.co/srvyr/reference/cur_svy.html" class="external-link">cur_svy</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                  type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Divide sample into propensity classes</span></span>
<span><span class="va">lou_vax_survey</span> <span class="op">&lt;-</span> <span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PROPENSITY_CELL <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ntile.html" class="external-link">ntile</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RESPONSE_PROPENSITY</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">PROPENSITY_CELL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">RESPONSE_PROPENSITY</span><span class="op">)</span>,</span>
<span>              mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">RESPONSE_PROPENSITY</span><span class="op">)</span>,</span>
<span>              max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">RESPONSE_PROPENSITY</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 5</span></span></span>
<span><span class="co">#&gt;   PROPENSITY_CELL     n   min  mean   max</span></span>
<span><span class="co">#&gt;             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>               1   200 0.357 0.424 0.459</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>               2   200 0.459 0.484 0.488</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>               3   200 0.488 0.488 0.512</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>               4   200 0.512 0.551 0.564</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>               5   200 0.564 0.564 0.564</span></span>
<span></span>
<span><span class="co"># Redistribute weights by propensity class</span></span>
<span><span class="va">nr_adjusted_survey</span> <span class="op">&lt;-</span> <span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/redistribute_weights.html">redistribute_weights</a></span><span class="op">(</span></span>
<span>    reduce_if <span class="op">=</span> <span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Nonrespondent"</span>,</span>
<span>    increase_if <span class="op">=</span> <span class="va">RESPONSE_STATUS</span> <span class="op">==</span> <span class="st">"Respondent"</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"PROPENSITY_CELL"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect weights before adjustment</span></span>
<span></span>
<span><span class="va">lou_vax_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summarize_rep_weights.html">summarize_rep_weights</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"specific"</span>,</span>
<span>                        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PROPENSITY_CELL"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Rep_Column</span>, <span class="va">PROPENSITY_CELL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">PROPENSITY_CELL</span>, <span class="va">Rep_Column</span>,</span>
<span>         <span class="va">N_NONZERO</span>, <span class="va">SUM</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    PROPENSITY_CELL Rep_Column N_NONZERO      SUM</span></span>
<span><span class="co">#&gt; 1                1          1       129 116473.4</span></span>
<span><span class="co">#&gt; 2                2          1       132 128419.3</span></span>
<span><span class="co">#&gt; 3                3          1       130 119459.9</span></span>
<span><span class="co">#&gt; 4                4          1       119 117668.0</span></span>
<span><span class="co">#&gt; 5                5          1       122 114681.5</span></span>
<span><span class="co">#&gt; 6                1          2       122 115876.1</span></span>
<span><span class="co">#&gt; 7                2          2       118 110500.4</span></span>
<span><span class="co">#&gt; 8                3          2       129 123641.0</span></span>
<span><span class="co">#&gt; 9                4          2       130 117070.7</span></span>
<span><span class="co">#&gt; 10               5          2       138 129613.9</span></span>
<span></span>
<span><span class="co"># Inspect weights after adjustment</span></span>
<span><span class="va">nr_adjusted_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summarize_rep_weights.html">summarize_rep_weights</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"specific"</span>,</span>
<span>                        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PROPENSITY_CELL"</span>, <span class="st">"RESPONSE_STATUS"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Rep_Column</span>, <span class="va">PROPENSITY_CELL</span>, <span class="va">RESPONSE_STATUS</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">PROPENSITY_CELL</span>, <span class="va">RESPONSE_STATUS</span>, <span class="va">Rep_Column</span>,</span>
<span>         <span class="va">N_NONZERO</span>, <span class="va">SUM</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    PROPENSITY_CELL RESPONSE_STATUS Rep_Column N_NONZERO      SUM</span></span>
<span><span class="co">#&gt; 1                1   Nonrespondent          1         0      0.0</span></span>
<span><span class="co">#&gt; 2                1      Respondent          1        56 116473.4</span></span>
<span><span class="co">#&gt; 3                2   Nonrespondent          1         0      0.0</span></span>
<span><span class="co">#&gt; 4                2      Respondent          1        63 128419.3</span></span>
<span><span class="co">#&gt; 5                3   Nonrespondent          1         0      0.0</span></span>
<span><span class="co">#&gt; 6                3      Respondent          1        58 119459.9</span></span>
<span><span class="co">#&gt; 7                4   Nonrespondent          1         0      0.0</span></span>
<span><span class="co">#&gt; 8                4      Respondent          1        59 117668.0</span></span>
<span><span class="co">#&gt; 9                5   Nonrespondent          1         0      0.0</span></span>
<span><span class="co">#&gt; 10               5      Respondent          1        73 114681.5</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="saving-the-final-weights-to-a-data-file">Saving the final weights to a data file<a class="anchor" aria-label="anchor" href="#saving-the-final-weights-to-a-data-file"></a>
</h2>
<p>Once we’re satisfied with the weights, we can create a data frame
with the analysis variables and columns of replicate weights. This
format is easy to export to data files that can be loaded into R or
other software later.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_frame_with_nr_adjusted_weights</span> <span class="op">&lt;-</span> <span class="va">nr_adjusted_survey</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_data_frame_with_weights.html">as_data_frame_with_weights</a></span><span class="op">(</span></span>
<span>    full_wgt_name <span class="op">=</span> <span class="st">"NR_ADJ_WGT"</span>,</span>
<span>    rep_wgt_prefix <span class="op">=</span> <span class="st">"NR_ADJ_REP_WGT_"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview first few column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data_frame_with_nr_adjusted_weights</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "RESPONSE_STATUS"     "RACE_ETHNICITY"      "SEX"                </span></span>
<span><span class="co">#&gt;  [4] "EDUC_ATTAINMENT"     "VAX_STATUS"          "SAMPLING_WEIGHT"    </span></span>
<span><span class="co">#&gt;  [7] "RESPONSE_PROPENSITY" "PROPENSITY_CELL"     "NR_ADJ_WGT"         </span></span>
<span><span class="co">#&gt; [10] "NR_ADJ_REP_WGT_1"    "NR_ADJ_REP_WGT_2"    "NR_ADJ_REP_WGT_3"</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Write the data to a CSV file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">data_frame_with_nr_adjusted_weights</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"survey-data-with-nonresponse-adjusted-weights.csv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="statistical-background">Statistical background<a class="anchor" aria-label="anchor" href="#statistical-background"></a>
</h2>
<p>The motivation for making this adjustment is that standard methods of
statistical inference assume that every person in the population has a
known, nonzero probability of participating in the survey (i.e. has a
nonzero chance of being sampled and a nonzero chance of responding if
they are sampled), denoted <span class="math inline">\(p_{i,overall}\)</span>. Basic results in survey
sampling theory guarantee that if this assumption is true, we can
produce unbiased estimates of population means and totals by weighting
data from each respondent with the weight <span class="math inline">\(1/{p_{i,overall}}\)</span>. Crucially, the overall
probability of participation <span class="math inline">\(p_{i,overall}\)</span> is the product of two
components: the probability that a person is sampled (denoted <span class="math inline">\(\pi_i\)</span>), and the probability that a person
would respond to the survey if they are sampled (denoted <span class="math inline">\(p_i\)</span> and referred to as the
<strong>“response propensity”</strong>). The sampling probability <span class="math inline">\(\pi_i\)</span> is known since we can control the
method of sampling, but the response propensity <span class="math inline">\(p_i\)</span> is unknown and can only be
estimated.</p>
<p><span class="math display">\[
\begin{aligned}
w^{*}_i &amp;= 1/p_{i,overall} \text{ (weights needed for unbiased
estimation)} \\
p_{i,overall} &amp;= \pi_i \times p_i \\
\pi_i &amp;= \textbf{Sampling probability} \\
&amp;\textit{i.e. the probability that case }i\textit{ is randomly
sampled } \text{ (}\textit{Known}\text{)} \\
p_i &amp;= \textbf{Response propensity} \\
&amp;\textit{i.e. the probability that case }i\textit{ responds, if
sampled } \text{ (}\textit{Unknown}\text{)}  \\
\end{aligned}
\]</span></p>
<p>The component <span class="math inline">\(p_i\)</span> must be
estimated using data (with estimate <span class="math inline">\(\hat{p}_i\)</span>) and then nonresponse-adjusted
weights for respondents can be formed as <span class="math inline">\(w_{NR,i} = 1/(\pi_i \times \hat{p}_i)\)</span> and
used to obtain approximately unbiased estimates of population means and
totals. To use our earlier notation, the nonresponse adjustment factor
for respondents <span class="math inline">\(f_{NR,i}\)</span> is
actually defined using <span class="math inline">\(1/\hat{p}_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
w_i &amp;= \textit{Original sampling weight for case }i \\
    &amp;= 1/\pi_i, \textit{ where } \pi_i \textit{ is the probability
case i }\textit{had of being sampled}\\
w_{NR, i} &amp;= w_i \times f_{NR,i} = \textit{Weight for case }i
\textit{ after nonresponse adjustment} \\
\\
f_{NR,i} &amp;= \begin{cases}
  0 &amp; \text{if case } i \text{ is a nonrespondent} \\
  1 / \hat{p}_i &amp; \text{if case } i \text{ is a respondent} \\
\end{cases} \\
\hat{p}_i &amp;= \textbf{Estimated response propensity}
\end{aligned}
\]</span></p>
<p>In essence, different methods of nonresponse weighting adjustments
vary in terms of how they estimate <span class="math inline">\(\hat{p}_i\)</span>. The basic weight
redistribution method in effect estimates <span class="math inline">\(p_i\)</span> as constant across all <span class="math inline">\(i\)</span>, equal to the overall weighted response
rate, and uses that to form the weights. In other words, the basic
weight redistribution essentially is a way of forming an adjustment
factor <span class="math inline">\(f_{NR,i}\)</span> based on the
estimated response propensity <span class="math inline">\(\hat{p}_i =
\frac{\sum_{i \in s_{resp}}w_i}{\sum_{i \in s}w_i}\)</span>.</p>
<p>Weighting class adjustments and propensity cell adjustments are
essentially more refined ways of forming <span class="math inline">\(f_{NR,i}\)</span> by estimating <span class="math inline">\(p_i\)</span> with a more realistic model, where
<span class="math inline">\(p_i\)</span> is not constant across the
entire sample but instead varies among weighting classes or propensity
cells.</p>
<p>The reason for conducting weighting adjustments not only in the
full-sample weights but in the replicate weights is to account for the
nonresponse adjustment process when estimating sampling variances and
inferential statistics such as confidence intervals. Because of random
sampling, the adjustment factors used in the nonresponse adjustment will
vary from one sample to the next, and applying weighting adjustments
separately for each replicate reflects this variability. As we’ve seen
in this vignette, the <code><a href="../reference/redistribute_weights.html">redistribute_weights()</a></code> function
handles this for us: after nonresponse adjustment, all of the weight in
each replicate is redistributed in the same manner that weight was
redistributed for the full-sample weights.</p>
</div>
<div class="section level2">
<h2 id="recommended-reading">Recommended Reading<a class="anchor" aria-label="anchor" href="#recommended-reading"></a>
</h2>
<ul>
<li>See Chapter 2, Section 2.7.3 of “Applied Survey Data Analysis” for a
statistical explanation of the weighting adjustments described in this
vignette.</li>
</ul>
<blockquote>
<p>Heeringa, S., West, B., Berglund, P. (2017). Applied Survey Data
Analysis, 2nd edition. Boca Raton, FL: CRC Press.</p>
</blockquote>
<ul>
<li>Chapter 13 of “Practical Tools for Designing and Weighting Survey
Samples” also provides an excellent overview of nonresponse adjustment
methods.</li>
</ul>
<blockquote>
<p>Valliant, R., Dever, J., Kreuter, F. (2018). Practical Tools for
Designing and Weighting Survey Samples, 2nd edition. New York:
Springer.</p>
</blockquote>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Schneider.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
